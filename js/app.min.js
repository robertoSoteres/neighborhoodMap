function viewModel(){var e=this;this.searchTerm=ko.observable(""),this.listaLugares=ko.observableArray([]),map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.484225,lng:-3.701123},zoom:12}),ko.onError=function(e){alert("Error --\x3e ",e)},lugares.forEach(function(t){e.listaLugares.push(new lugar(t))}),this.filtrarLista=ko.computed(function(){var t=e.searchTerm().toLowerCase();return t?ko.utils.arrayFilter(e.listaLugares(),function(e){var a=e.name.toLowerCase().search(t)>=0;return e.visible(a),a}):(e.listaLugares().forEach(function(e){e.visible(!0)}),e.listaLugares())},e)}function init(){ko.applyBindings(new viewModel)}function errorMap(){alert("Google maps has failed.")}var lugares=[{nombre:"Cines La Vaguada",lat:40.482837,long:-3.707618,placeID:"ChIJfcPuDJwpQg0RUGr2lxan8DA"},{nombre:"Cinesa Manoteras",lat:40.486345,long:-3.66574,placeID:"ChIJMXa3qDohQg0RXPRJGqfP9ls"},{nombre:"Autocine Fuencarral",lat:40.485569,long:-3.678341,placeID:"ChIJU5xT7FwpQg0RYOKcJVNVB0s"},{nombre:"Kin√©polis Diversia",lat:40.530067,long:-3.639312,placeID:"ChIJHyaMsV0sQg0RoRzZUkypj5E"},{nombre:"Cine Plaza norte 2",lat:40.541287,long:-3.615794,placeID:"ChIJZ1V8C94sQg0R4FhCviwku6s"}],map,lugar=function(e){var t=this;this.name=e.nombre,this.lat=e.lat,this.long=e.long,this.placeID=e.placeID,this.address="",this.telf="",this.visible=ko.observable(!0),this.temp=0,this.clouds="",this.stationName="",this.InfoWindow=new google.maps.InfoWindow({content:t.contentString});var a=new google.maps.places.PlacesService(map),n="http://api.geonames.org/findNearByWeatherJSON?lat="+t.lat+"&lng="+t.long+"&username=roberto.soteres";$.getJSON(n,function(e){t.temp=e.weatherObservation.temperature,t.clouds=e.weatherObservation.clouds,t.stationName=e.weatherObservation.stationName}).fail(function(error, textStatus){alert("Error Status: " + textStatus)}),a.getDetails({placeId:e.placeID},function(e,a){a===google.maps.places.PlacesServiceStatus.OK&&(t.address=e.formatted_address,t.telf=e.formatted_phone_number)}),this.Marker=new google.maps.Marker({position:new google.maps.LatLng(e.lat,e.long),map:map,icon:"images/cinemaImage.png",title:e.nombre}),this.Marker.addListener("click",function(){t.contentString='<div class="info-window-content"><div class="title"><b>'+e.nombre+'</b></div><div class="content">Address: '+t.address+'</div><div class="content">Phone: '+t.telf+'</div><div class="content">Temperature: '+t.temp+'</div><div class="content">Clouds: '+t.clouds+'</div><div class="content">Station: '+t.stationName+'</div><div class="content">Lat: '+t.lat+'</div><div class="content">Long: '+t.long+"</div></div>",t.InfoWindow.setContent(t.contentString),t.InfoWindow.open(map,this),t.Marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){t.Marker.setAnimation(null)},3550)}),this.showMarker=ko.computed(function(){return!0===this.visible()?this.Marker.setMap(map):this.Marker.setMap(null),!0},this),this.animacion=function(e){google.maps.event.trigger(t.Marker,"click")},$("#nav-icon").click(function(){$(this).hasClass("open")?($(this).removeClass("open"),$("#search").css("left","-50vw")):($(this).toggleClass("open"),$("#search").css("left",0))})};
